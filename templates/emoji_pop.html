{% extends "base.html" %}

{% block title %}Emoji Pop - Birthday Surprise{% endblock %}

{% block body_class %}emoji-pop-bg{% endblock %}

{% block content %}
<div class="emoji-pop-container">
    <h1 class="game-title" data-translate="emoji_pop_game_title">üí• Emoji Pop Challenge</h1>
    
    <!-- Name Input Screen -->
    <div class="name-input-screen" id="name-input-screen">
        <p class="game-instructions" data-translate="emoji_pop_instructions">Pop emojis and build combos for up to 6x multiplier! 30 seconds of fast-paced fun!</p>
        <div class="name-input-box">
            <label for="player-name" data-translate="enter_name">Enter Your Name:</label>
            <input type="text" id="player-name" maxlength="20" placeholder="Your name">
            <p class="name-error" id="name-error" style="display: none;" data-translate="name_error">Please enter a valid name</p>
            <button class="start-game-btn" id="start-game-btn" data-translate="start_game">Start Game</button>
        </div>
        
        <!-- Leaderboard on Name Input Screen -->
        <div class="leaderboard" style="margin-top: 40px;">
            <h3 data-translate="leaderboard_title">üèÜ Leaderboard</h3>
            <ol id="leaderboard-list-start">
                <!-- Leaderboard entries will be added here -->
            </ol>
        </div>
    </div>
    
    <!-- Game Screen -->
    <div class="game-screen" id="game-screen" style="display: none;">
        <div class="game-stats">
            <div class="stat-item">
                <span data-translate="score_label">Score:</span>
                <span id="score">0</span>
            </div>
            <div class="stat-item">
                <span data-translate="time_label">Time:</span>
                <span id="timer">30</span>s
            </div>
            <div class="stat-item multiplier-display" id="multiplier-display" style="visibility: hidden;">
                <span>üî•</span>
                <span id="multiplier">1</span>x
            </div>
            <button class="pause-btn" id="pause-btn" data-translate="pause_button">‚è∏Ô∏è Pause</button>
            <button class="restart-btn" id="restart-btn" onclick="showRestartModal()" data-translate="restart_button">üîÑ Restart</button>
        </div>
        
        <div class="countdown-overlay" id="countdown-overlay" style="display: none;">
            <div class="countdown-number" id="countdown-number">3</div>
        </div>
        
        <div class="emoji-spawn-area" id="emoji-spawn-area">
            <!-- Emojis will spawn here -->
            <!-- Multiplier popup -->
            <div class="multiplier-popup" id="multiplier-popup">x2</div>
        </div>
        
        <!-- Combo Meter -->
        <div class="combo-meter-container" id="combo-meter-container">
            <div class="combo-meter-label">
                <span id="combo-level-text">COMBO</span>
                <span id="combo-multiplier-text">x1</span>
            </div>
            <div class="combo-meter-bar">
                <div class="combo-meter-fill" id="combo-meter-fill"></div>
            </div>
        </div>
    </div>
    
    <!-- Game Over Screen -->
    <div class="game-over-screen" id="game-over-screen" style="display: none;">
        <h2 data-translate="game_over">Game Over!</h2>
        <p class="final-score">
            <span data-translate="your_score">Your Score:</span>
            <span id="final-score">0</span>
        </p>
        <button class="play-again-btn" id="play-again-btn" data-translate="play_again">Play Again</button>
        
        <div class="leaderboard">
            <h3 data-translate="leaderboard_title">üèÜ Leaderboard</h3>
            <ol id="leaderboard-list">
                <!-- Leaderboard entries will be added here -->
            </ol>
        </div>
    </div>
    
    <div class="game-nav">
        <button class="back-button" onclick="handleBackButtonClick(event); return false;" data-translate="back_games">‚Üê Back to Games</button>
    </div>
    
    <!-- Play Again Modal -->
    <div class="play-again-modal" id="play-again-modal" style="display: none;">
        <div class="modal-content">
            <h3 data-translate="play_again_title">Play Again?</h3>
            <p data-translate="play_again_question">Would you like to play again?</p>
            <div class="modal-buttons">
                <button class="modal-btn same-name-btn" id="same-name-btn" data-translate="same_name">
                    Continue as <span id="current-player-name"></span>
                </button>
                <button class="modal-btn new-name-btn" id="new-name-btn" data-translate="new_name">
                    Play as Different Person
                </button>
            </div>
        </div>
    </div>
    
    <!-- Exit Confirmation Modal -->
    <div class="play-again-modal" id="exit-confirmation-modal" style="display: none;">
        <div class="modal-content">
            <h3 data-translate="exit_game_title">Exit Game?</h3>
            <p data-translate="exit_game_question">Are you sure you want to exit? Your current game will be lost.</p>
            <div class="modal-buttons">
                <button class="modal-btn new-name-btn" id="exit-yes-btn" data-translate="exit_yes">
                    Yes, Exit
                </button>
                <button class="modal-btn same-name-btn" id="exit-no-btn" data-translate="exit_no">
                    No, Continue Playing
                </button>
            </div>
        </div>
    </div>
    
    <!-- Restart Confirmation Modal -->
    <div class="play-again-modal" id="restart-confirmation-modal" style="display: none;">
        <div class="modal-content">
            <h3 data-translate="restart_game_title">Restart Game?</h3>
            <p data-translate="restart_game_question">Are you sure you want to restart? Your current game will be lost.</p>
            <div class="modal-buttons">
                <button class="modal-btn new-name-btn" id="restart-yes-btn" data-translate="restart_yes">
                    Yes, Restart
                </button>
                <button class="modal-btn same-name-btn" id="restart-no-btn" data-translate="restart_no">
                    No, Continue Playing
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Confetti Container -->
<div class="confetti-container" id="confetti-container"></div>
<div class="confetti-celebration-message" id="celebration-message"></div>

<!-- Pause Overlay -->
<div class="pause-overlay" id="pause-overlay">
    <div class="pause-content">
        <div class="pause-icon">‚è∏Ô∏è</div>
        <div class="pause-text" data-translate="game_paused">PAUSED</div>
        <div class="pause-hint" data-translate="pause_hint">Press SPACE or ‚ñ∂Ô∏è Resume to continue</div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/emoji_pop.js') }}"></script>
{% endblock %}
